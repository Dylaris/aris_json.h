# cjson

## Brief

`cjson` is a single-header-file C library for serializing and deserializing JSON.

- serialization: Elements (generated by C functions) are converted into the internal tree structure of `cjson_t` and can be output to a `FILE`.

- deserialization: It parses a JSON buffer into the internal tree structure of `cjson_t`. The parsed content becomes a new value (object or array), assigned a new key, and then added as a new pair in the tree.

## Dependency

- `stb_c_lexer_h`: Used to parse the tokens in the JSON file.

## Usage

```shell
$ clang -o sbc build/sbc.c 
$ ./sbc
```

- serialization

```c
cjson_object_begin(&cj);
    cjson_key(&cj, "string");
    cjson_string(&cj, "hello");

    cjson_key(&cj, "number");
    cjson_number(&cj, 1.2);

    cjson_key(&cj, "boolean");
    cjson_boolean(&cj, false);

    cjson_key(&cj, "null");
    cjson_null(&cj);
cjson_object_end(&cj);
```

```shell
output:

{
    "string": "hello",
    "number": 1.2,
    "boolean": false,
    "null": null
}
```

- deserialization

```c
const char *object = "{\"name\": \"Jack\", \"age\": 20, \"student\": false, }";

if (!cjson_parse(&cj, object, strlen(object))) return 1;

CJson_Value *name = cjson_query(cj.root, "name");
assert(name != NULL);
printf("name: %s\n", name->as.string);

CJson_Value *age = cjson_query(cj.root, "age");
assert(age != NULL);
printf("age: %d\n", (int)age->as.number);
```

```shell
output:

name: Jack
age: 20
```

## Reference

- [tsoding/jim](https://github.com/tsoding/jim)
